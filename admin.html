<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="robots" content="noindex, nofollow">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Admin Dashboard | Ryan's Web Services</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon_io/favicon-32x32.png">
</head>
<body class="admin-body">
    <!-- Login Screen -->
    <div id="loginScreen" class="admin-login">
        <div class="admin-login-card">
            <div class="admin-login-logo">
                <h1>üîê Admin Portal</h1>
                <p>Sign in to access the dashboard</p>
            </div>
            <div id="loginError" class="admin-login-error"></div>
            <form id="adminLoginForm">
                <div class="form-group">
                    <label for="adminEmail">Email Address</label>
                    <input type="email" id="adminEmail" required autocomplete="username" placeholder="admin@example.com">
                </div>
                <div class="form-group">
                    <label for="adminPassword">Password</label>
                    <input type="password" id="adminPassword" required autocomplete="current-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button type="submit" class="admin-login-btn">Sign In</button>
            </form>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="admin-wrapper" style="display: none;">
        <div class="sidebar-overlay" id="sidebarOverlay"></div>
        
        <!-- Sidebar -->
        <aside class="admin-sidebar" id="adminSidebar">
            <div class="sidebar-brand">
                <h1>‚ö° RWS Admin</h1>
            </div>
            
            <div class="sidebar-user">
                <div class="sidebar-user-avatar" id="sidebarUserAvatar">A</div>
                <div class="sidebar-user-info">
                    <div class="sidebar-user-name" id="sidebarUserName">Admin</div>
                    <div class="sidebar-user-role">Administrator</div>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Dashboard</div>
                    <button class="sidebar-link active" data-section="overview">
                        <span class="sidebar-link-icon">üìä</span>
                        Overview
                    </button>
                </div>
                
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Management</div>
                    <button class="sidebar-link" data-section="analytics">
                        <span class="sidebar-link-icon">üìà</span>
                        Analytics
                    </button>
                    <button class="sidebar-link" data-section="users">
                        <span class="sidebar-link-icon">üë•</span>
                        Users
                    </button>
                    <button class="sidebar-link" data-section="requests">
                        <span class="sidebar-link-icon">üìã</span>
                        Service Requests
                    </button>
                    <button class="sidebar-link" data-section="quotes">
                        <span class="sidebar-link-icon">üé´</span>
                        Custom Quotes
                    </button>
                    <button class="sidebar-link" data-section="payments">
                        <span class="sidebar-link-icon">üí≥</span>
                        Payments
                    </button>
                    <button class="sidebar-link" data-section="files">
                        <span class="sidebar-link-icon">üìÅ</span>
                        Files
                    </button>
                </div>
                
                <div class="sidebar-section">
                    <div class="sidebar-section-title">Communication</div>
                    <button class="sidebar-link" data-section="messages">
                        <span class="sidebar-link-icon">üí¨</span>
                        Messages
                        <span class="sidebar-link-badge" id="navMessagesBadge" style="display: none;">0</span>
                    </button>
                    <button class="sidebar-link" data-section="contacts">
                        <span class="sidebar-link-icon">üì¨</span>
                        Contact Forms
                        <span class="sidebar-link-badge" id="navContactsBadge" style="display: none;">0</span>
                    </button>
                    <button class="sidebar-link" data-section="blog">
                        <span class="sidebar-link-icon">üìù</span>
                        Blog Posts
                    </button>
                </div>
            </nav>
            
            <div class="sidebar-footer">
                <button class="sidebar-logout" onclick="adminPanel.handleLogout()">
                    <span>üö™</span>
                    Sign Out
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <header class="admin-header">
                <button class="admin-menu-toggle" id="mobileMenuBtn">‚ò∞</button>
                
                <div class="admin-search">
                    <span class="admin-search-icon">üîç</span>
                    <input type="text" id="globalSearchInput" placeholder="Search users, requests, payments...">
                </div>
                
                <div class="admin-header-actions">
                    <button class="admin-header-btn" id="reloadBtn">üîÑ Refresh</button>
                </div>
            </header>

            <div class="admin-content">
                <!-- Overview Section -->
                <section class="admin-section active" id="section-overview">
                    <div class="page-header">
                        <h2>üìä Dashboard Overview</h2>
                        <p>Your business at a glance</p>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-card-header">
                                <div class="stat-card-icon blue">üë•</div>
                            </div>
                            <div class="stat-card-value" id="totalUsers">0</div>
                            <div class="stat-card-label">Total Users</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-card-header">
                                <div class="stat-card-icon green">üí∞</div>
                            </div>
                            <div class="stat-card-value" id="totalRevenue">$0</div>
                            <div class="stat-card-label">Total Revenue</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-card-header">
                                <div class="stat-card-icon purple">üìã</div>
                            </div>
                            <div class="stat-card-value" id="totalRequests">0</div>
                            <div class="stat-card-label">Service Requests</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-card-header">
                                <div class="stat-card-icon orange">üìÅ</div>
                            </div>
                            <div class="stat-card-value" id="totalFiles">0</div>
                            <div class="stat-card-label">Files Stored</div>
                        </div>
                    </div>

                    <div class="data-card">
                        <div class="data-card-header">
                            <div class="data-card-title">üïê Recent Activity</div>
                        </div>
                        <div class="data-card-body" id="recentActivityContainer">
                            <div class="loading">
                                <div class="loading-spinner"></div>
                                Loading activity...
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Analytics Section -->
                <section class="admin-section" id="section-analytics">
                    <div class="page-header">
                        <h2>üìà Visitor Analytics</h2>
                        <p>Track website traffic and engagement</p>
                    </div>
                    
                    <div class="data-card">
                        <div class="data-card-header">
                            <div class="data-card-title">Time Period</div>
                            <div class="filter-bar" style="margin: 0;">
                                <select class="filter-select" id="analyticsDateRange" onchange="adminPanel.loadAnalytics()">
                                    <option value="1">Today</option>
                                    <option value="7" selected>Last 7 Days</option>
                                    <option value="30">Last 30 Days</option>
                                    <option value="90">Last 90 Days</option>
                                </select>
                                <button class="btn btn-ghost btn-sm" onclick="adminPanel.loadAnalytics()">üîÑ Refresh</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-card-header">
                                <div class="stat-card-icon blue">üëÅÔ∏è</div>
                            </div>
                            <div class="stat-card-value" id="totalPageViews">0</div>
                            <div class="stat-card-label">Page Views</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-card-header">
                                <div class="stat-card-icon green">üë§</div>
                            </div>
                            <div class="stat-card-value" id="uniqueVisitors">0</div>
                            <div class="stat-card-label">Unique Visitors</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-card-header">
                                <div class="stat-card-icon purple">‚è±Ô∏è</div>
                            </div>
                            <div class="stat-card-value" id="avgTimeOnSite">0s</div>
                            <div class="stat-card-label">Avg. Time on Site</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-card-header">
                                <div class="stat-card-icon orange">üìâ</div>
                            </div>
                            <div class="stat-card-value" id="bounceRate">0%</div>
                            <div class="stat-card-label">Bounce Rate</div>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                        <div class="data-card">
                            <div class="data-card-header">
                                <div class="data-card-title">üìÑ Top Pages</div>
                            </div>
                            <div class="data-card-body" id="topPagesContainer">
                                <div class="loading">Loading...</div>
                            </div>
                        </div>
                        <div class="data-card">
                            <div class="data-card-header">
                                <div class="data-card-title">üåç Top Locations</div>
                            </div>
                            <div class="data-card-body" id="topLocationsContainer">
                                <div class="loading">Loading...</div>
                            </div>
                        </div>
                    </div>

                    <div class="data-card">
                        <div class="data-card-header">
                            <div class="data-card-title">üë• Recent Visitors</div>
                            <input type="text" class="filter-input" id="visitorSearch" placeholder="Search visitors..." onkeyup="adminPanel.filterVisitors()">
                        </div>
                        <div class="data-card-body" style="overflow-x: auto;">
                            <table class="admin-table" id="visitorsTable">
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>Page</th>
                                        <th>Location</th>
                                        <th>Device</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="visitorsTableBody">
                                    <tr><td colspan="5" class="loading">Loading...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Users Section -->
                <section class="admin-section" id="section-users">
                    <div class="page-header">
                        <h2>üë• User Management</h2>
                        <p>Manage registered users</p>
                    </div>
                    
                    <div class="data-card">
                        <div class="data-card-header">
                            <div class="data-card-title">All Users</div>
                        </div>
                        <div class="data-card-body">
                            <div class="filter-bar">
                                <input type="text" class="filter-input" id="userSearch" placeholder="üîç Search users...">
                                <select class="filter-select" id="userFilter">
                                    <option value="all">All Users</option>
                                    <option value="verified">Verified Only</option>
                                    <option value="unverified">Unverified</option>
                                    <option value="admin">Admins</option>
                                </select>
                            </div>
                            <div id="usersTableContainer">
                                <div class="loading">
                                    <div class="loading-spinner"></div>
                                    Loading users...
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Service Requests Section -->
                <section class="admin-section" id="section-requests">
                    <div class="page-header">
                        <h2>üìã Service Requests</h2>
                        <p>Manage client requests</p>
                    </div>
                    
                    <div class="data-card">
                        <div class="data-card-header">
                            <div class="data-card-title">All Requests</div>
                        </div>
                        <div class="data-card-body">
                            <div class="filter-bar">
                                <input type="text" class="filter-input" id="requestSearch" placeholder="üîç Search requests...">
                                <select class="filter-select" id="requestStatusFilter">
                                    <option value="all">All Status</option>
                                    <option value="pending">Pending</option>
                                    <option value="in_progress">In Progress</option>
                                    <option value="ready_to_purchase">Ready to Purchase</option>
                                    <option value="paid">Paid</option>
                                    <option value="cancelled">Cancelled</option>
                                </select>
                            </div>
                            <div id="requestsTableContainer">
                                <div class="loading">
                                    <div class="loading-spinner"></div>
                                    Loading requests...
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Custom Quotes Section -->
                <section class="admin-section" id="section-quotes">
                    <div class="page-header">
                        <h2>üé´ Custom Quotes</h2>
                        <p>Create personalized pricing for clients</p>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 280px 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                        <div class="data-card" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1)); border-color: rgba(99, 102, 241, 0.3);">
                            <div class="data-card-body" style="text-align: center;">
                                <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">‚ú®</div>
                                <h3 style="font-size: 1rem; margin-bottom: 0.5rem;">New Quote</h3>
                                <p style="font-size: 0.8rem; color: var(--admin-text-muted); margin-bottom: 1rem;">Generate custom pricing for a client</p>
                                <button class="btn btn-primary" id="createQuoteBtn" style="width: 100%;">+ Create Quote</button>
                            </div>
                        </div>
                        
                        <div class="stats-grid" style="margin: 0;">
                            <div class="stat-card">
                                <div class="stat-card-value" style="color: #60a5fa;" id="pendingQuotes">0</div>
                                <div class="stat-card-label">Pending</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-card-value" style="color: #fbbf24;" id="viewedQuotes">0</div>
                                <div class="stat-card-label">Viewed</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-card-value" style="color: #34d399;" id="redeemedQuotes">0</div>
                                <div class="stat-card-label">Redeemed</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-card-value" style="color: #a78bfa;" id="quotesValue">$0</div>
                                <div class="stat-card-label">Total Value</div>
                            </div>
                        </div>
                    </div>

                    <div class="data-card">
                        <div class="data-card-header">
                            <div class="data-card-title">All Quote Codes</div>
                            <div class="filter-bar" style="margin: 0;">
                                <input type="text" class="filter-input" id="quoteSearch" placeholder="üîç Search quotes...">
                                <select class="filter-select" id="quoteStatusFilter">
                                    <option value="all">All Status</option>
                                    <option value="pending">Pending</option>
                                    <option value="viewed">Viewed</option>
                                    <option value="redeemed">Redeemed</option>
                                    <option value="expired">Expired</option>
                                </select>
                            </div>
                        </div>
                        <div class="data-card-body" style="overflow-x: auto;">
                            <table class="admin-table" id="quotesTable">
                                <thead>
                                    <tr>
                                        <th>Code</th>
                                        <th>Client</th>
                                        <th>Upfront</th>
                                        <th>Monthly</th>
                                        <th>Status</th>
                                        <th>Expires</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="quotesTableBody">
                                    <tr><td colspan="7">
                                        <div class="empty-state">
                                            <div class="empty-state-icon">üé´</div>
                                            <h4>No quotes yet</h4>
                                            <p>Create your first custom quote</p>
                                        </div>
                                    </td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Payments Section -->
                <section class="admin-section" id="section-payments">
                    <div class="page-header">
                        <h2>üí≥ Payments & Invoices</h2>
                        <p>Track revenue and subscriptions</p>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-card-value" style="color: #34d399;" id="totalPaidRevenue">$0</div>
                            <div class="stat-card-label">Total Revenue</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-card-value" style="color: #fbbf24;" id="pendingPayments">$0</div>
                            <div class="stat-card-label">Pending</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-card-value" style="color: #a78bfa;" id="monthlyRecurring">$0</div>
                            <div class="stat-card-label">Monthly Recurring</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-card-value" style="color: #60a5fa;" id="activeSubscriptions">0</div>
                            <div class="stat-card-label">Active Subscriptions</div>
                        </div>
                    </div>

                    <div class="data-card">
                        <div class="data-card-header">
                            <div class="data-card-title">üéüÔ∏è Promo Codes</div>
                            <button class="btn btn-success btn-sm" id="createPromoBtn">+ Create Code</button>
                        </div>
                        <div class="data-card-body" id="promoCodesContainer">
                            <div class="loading">Loading promo codes...</div>
                        </div>
                    </div>

                    <div class="data-card">
                        <div class="data-card-header">
                            <div class="data-card-title">üí∞ All Orders</div>
                        </div>
                        <div class="data-card-body">
                            <div class="filter-bar">
                                <input type="text" class="filter-input" id="paymentSearch" placeholder="üîç Search orders...">
                                <select class="filter-select" id="paymentStatusFilter">
                                    <option value="all">All Orders</option>
                                    <option value="paid">Paid</option>
                                    <option value="ready_to_purchase">Awaiting Payment</option>
                                    <option value="pending">Pending</option>
                                    <option value="refunded">Refunded</option>
                                </select>
                            </div>
                            <div id="paymentsTableContainer">
                                <div class="loading">Loading orders...</div>
                            </div>
                        </div>
                    </div>

                    <div class="data-card">
                        <div class="data-card-header">
                            <div class="data-card-title">üîÑ Active Subscriptions</div>
                        </div>
                        <div class="data-card-body" id="subscriptionsTableContainer">
                            <div class="loading">Loading subscriptions...</div>
                        </div>
                    </div>
                </section>

                <!-- Files Section -->
                <section class="admin-section" id="section-files">
                    <div class="page-header">
                        <h2>üìÅ File Management</h2>
                        <p>Manage user documents</p>
                    </div>
                    
                    <div class="data-card">
                        <div class="data-card-header">
                            <div class="data-card-title">All Files</div>
                            <button class="btn btn-primary btn-sm" id="uploadFileBtn">+ Upload File</button>
                        </div>
                        <div class="data-card-body">
                            <div class="filter-bar">
                                <input type="text" class="filter-input" id="fileSearch" placeholder="üîç Search files...">
                            </div>
                            <div id="filesTableContainer">
                                <div class="loading">Loading files...</div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Messages Section -->
                <section class="admin-section" id="section-messages">
                    <div class="page-header">
                        <h2>üí¨ Messages</h2>
                        <p>Chat with users</p>
                    </div>
                    
                    <div class="messages-layout">
                        <div class="conversations-panel">
                            <div class="conversations-header">
                                <h4>Conversations</h4>
                                <div class="conversations-search">
                                    <span class="conversations-search-icon">üîç</span>
                                    <input type="text" id="adminConversationSearch" placeholder="Search...">
                                </div>
                            </div>
                            <div class="conversations-list" id="adminConversationsList">
                                <div class="loading" style="padding: 2rem;">Loading...</div>
                            </div>
                        </div>
                        
                        <div class="chat-panel">
                            <div class="chat-empty" id="adminNoConversation">
                                <div class="chat-empty-icon">üí¨</div>
                                <h4>Select a Conversation</h4>
                                <p>Choose from the list to view messages</p>
                            </div>
                            
                            <div id="adminChatView" style="display: none; flex-direction: column; height: 100%;">
                                <div class="chat-header">
                                    <div class="conversation-avatar" id="adminChatAvatar">U</div>
                                    <div class="chat-header-info">
                                        <h4 id="adminChatUserName">User</h4>
                                        <p id="adminChatUserEmail">email@example.com</p>
                                    </div>
                                </div>
                                <div class="chat-messages" id="adminChatMessages"></div>
                                <div class="chat-input">
                                    <input type="text" id="adminMessageInput" placeholder="Type a message...">
                                    <button class="chat-send-btn" id="adminSendBtn">Send</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Contacts Section -->
                <section class="admin-section" id="section-contacts">
                    <div class="page-header">
                        <h2>üì¨ Contact Submissions</h2>
                        <p>Review contact form messages</p>
                    </div>
                    
                    <div class="data-card">
                        <div class="data-card-header">
                            <div class="data-card-title">All Submissions</div>
                            <span class="badge badge-danger" id="newContactsBadge" style="display: none;">0 New</span>
                        </div>
                        <div class="data-card-body">
                            <div class="filter-bar">
                                <input type="text" class="filter-input" id="contactSearch" placeholder="üîç Search contacts...">
                                <select class="filter-select" id="contactStatusFilter">
                                    <option value="all">All</option>
                                    <option value="new">New</option>
                                    <option value="read">Read</option>
                                    <option value="replied">Replied</option>
                                    <option value="archived">Archived</option>
                                </select>
                            </div>
                            <div id="contactsTableContainer">
                                <div class="loading">Loading contacts...</div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Blog Section -->
                <section class="admin-section" id="section-blog">
                    <div class="page-header">
                        <h2>üìù Blog Posts</h2>
                        <p>Create and manage content</p>
                    </div>
                    
                    <div class="data-card">
                        <div class="data-card-header">
                            <div class="data-card-title">All Posts</div>
                            <button class="btn btn-success btn-sm" id="createPostBtn">+ New Post</button>
                        </div>
                        <div class="data-card-body" id="blogPostsContainer">
                            <div class="loading">Loading posts...</div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Upload Modal -->
    <div id="uploadModal" class="modal-overlay" style="display: none;">
        <div class="modal" style="max-width: 500px;">
            <div class="modal-header">
                <h3>üìÅ Upload File</h3>
                <button class="modal-close" id="closeUploadModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="uploadFileForm">
                    <div class="form-group">
                        <label>Select User</label>
                        <select id="userSelect" required></select>
                    </div>
                    <div class="form-group">
                        <label>File Name</label>
                        <input type="text" id="fileName" required placeholder="Document name">
                    </div>
                    <div class="form-group">
                        <label>Upload File</label>
                        <input type="file" id="fileUpload" required>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="fileDescription" rows="2" placeholder="Brief description..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-ghost" onclick="document.getElementById('uploadModal').style.display='none'">Cancel</button>
                <button class="btn btn-primary" type="submit" form="uploadFileForm">Upload</button>
            </div>
        </div>
    </div>

    <!-- Order Details Modal -->
    <div id="orderDetailsModal" class="modal-overlay" style="display: none;">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <h3>üì¶ Order Details</h3>
                <button class="modal-close" onclick="adminPanel.closeOrderModal()">&times;</button>
            </div>
            <div class="modal-body" id="orderDetailsContent">
                <div class="loading">Loading...</div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-ghost" onclick="adminPanel.closeOrderModal()">Close</button>
                <button class="btn btn-danger" id="modalRefundBtn" style="display: none;">Refund</button>
            </div>
        </div>
    </div>

    <!-- Promo Code Modal -->
    <div id="promoCodeModal" class="modal-overlay" style="display: none;">
        <div class="modal" style="max-width: 500px;">
            <div class="modal-header">
                <h3>üéüÔ∏è Create Promo Code</h3>
                <button class="modal-close" onclick="adminPanel.closePromoModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="promoCodeForm">
                    <div class="form-group">
                        <label>Code</label>
                        <input type="text" id="promoCode" placeholder="SAVE20" required style="text-transform: uppercase;">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <input type="text" id="promoDescription" placeholder="20% off for new customers">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Discount Type</label>
                            <select id="promoDiscountType" required>
                                <option value="percentage">Percentage (%)</option>
                                <option value="fixed">Fixed Amount ($)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Value</label>
                            <input type="number" id="promoDiscountValue" placeholder="20" min="0" step="0.01" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Max Uses</label>
                            <input type="number" id="promoMaxUses" placeholder="Unlimited" min="1">
                        </div>
                        <div class="form-group">
                            <label>Min Purchase ($)</label>
                            <input type="number" id="promoMinPurchase" placeholder="0" min="0" value="0">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Valid From</label>
                            <input type="date" id="promoValidFrom">
                        </div>
                        <div class="form-group">
                            <label>Valid Until</label>
                            <input type="date" id="promoValidUntil">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-ghost" onclick="adminPanel.closePromoModal()">Cancel</button>
                <button class="btn btn-success" onclick="adminPanel.createPromoCode()">Create</button>
            </div>
        </div>
    </div>

    <!-- Refund Modal -->
    <div id="refundModal" class="modal-overlay" style="display: none;">
        <div class="modal" style="max-width: 450px;">
            <div class="modal-header">
                <h3>üí∏ Issue Refund</h3>
                <button class="modal-close" onclick="adminPanel.closeRefundModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="refundDetails" style="margin-bottom: 1rem; padding: 1rem; background: var(--admin-surface-2); border-radius: 8px;">
                    <p><strong>Customer:</strong> <span id="refundCustomer"></span></p>
                    <p><strong>Service:</strong> <span id="refundService"></span></p>
                    <p><strong>Amount:</strong> <span id="refundOriginalAmount"></span></p>
                </div>
                <div class="form-group">
                    <label>Refund Type</label>
                    <select id="refundType" onchange="adminPanel.toggleRefundAmount()">
                        <option value="full">Full Refund</option>
                        <option value="partial">Partial Refund</option>
                    </select>
                </div>
                <div class="form-group" id="partialAmountGroup" style="display: none;">
                    <label>Refund Amount ($)</label>
                    <input type="number" id="refundAmount" placeholder="0.00" min="0.01" step="0.01">
                </div>
                <div class="form-group">
                    <label>Reason</label>
                    <select id="refundReason">
                        <option value="requested_by_customer">Requested by customer</option>
                        <option value="duplicate">Duplicate charge</option>
                        <option value="fraudulent">Fraudulent</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-ghost" onclick="adminPanel.closeRefundModal()">Cancel</button>
                <button class="btn btn-danger" onclick="adminPanel.processRefund()">Process Refund</button>
            </div>
        </div>
    </div>

    <!-- Blog Post Modal -->
    <div id="blogPostModal" class="modal-overlay" style="display: none;">
        <div class="modal" style="max-width: 700px;">
            <div class="modal-header">
                <h3 id="blogModalTitle">üìù Create Post</h3>
                <button class="modal-close" onclick="adminPanel.closeBlogModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="blogPostForm">
                    <input type="hidden" id="blogPostId">
                    <div class="form-group">
                        <label>Title *</label>
                        <input type="text" id="blogTitle" placeholder="Post title" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Slug</label>
                            <input type="text" id="blogSlug" placeholder="auto-generated">
                        </div>
                        <div class="form-group">
                            <label>Category</label>
                            <select id="blogCategory">
                                <option value="">Select...</option>
                                <option value="News">News</option>
                                <option value="Tips">Tips</option>
                                <option value="Updates">Updates</option>
                                <option value="Tutorial">Tutorial</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Excerpt</label>
                        <textarea id="blogExcerpt" rows="2" placeholder="Brief summary..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Featured Image URL</label>
                        <input type="url" id="blogFeaturedImage" placeholder="https://...">
                    </div>
                    <div class="form-group">
                        <label>Content * (HTML supported)</label>
                        <textarea id="blogContent" rows="10" placeholder="Write content..." required style="font-family: monospace;"></textarea>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="blogPublished" style="width: auto;">
                            Publish immediately
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-ghost" onclick="adminPanel.closeBlogModal()">Cancel</button>
                <button class="btn btn-success" onclick="adminPanel.saveBlogPost()">Save Post</button>
            </div>
        </div>
    </div>

    <!-- Quote Modal -->
    <div id="quoteModal" class="modal-overlay" style="display: none;">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <h3 id="quoteModalTitle">üé´ Create Quote</h3>
                <button class="modal-close" onclick="adminPanel.closeQuoteModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="generatedCodeDisplay" style="display: none; background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(139, 92, 246, 0.15)); border: 1px solid rgba(99, 102, 241, 0.3); padding: 1rem; border-radius: 12px; text-align: center; margin-bottom: 1rem;">
                    <div style="font-size: 0.7rem; color: #a5b4fc; text-transform: uppercase; letter-spacing: 1px;">Quote Code</div>
                    <div id="generatedCode" style="font-size: 1.5rem; font-weight: 700; font-family: monospace; letter-spacing: 2px;"></div>
                    <button type="button" class="btn btn-ghost btn-sm" style="margin-top: 0.5rem;" onclick="adminPanel.copyQuoteCode(document.getElementById('generatedCode').textContent)">üìã Copy</button>
                </div>
                <form id="quoteForm">
                    <div style="margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--admin-border);">
                        <h4 style="font-size: 0.8rem; color: var(--admin-text-muted); text-transform: uppercase;">üë§ Client Info</h4>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Name</label>
                            <input type="text" id="quoteClientName" placeholder="John Doe">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="quoteClientEmail" placeholder="john@example.com">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Phone</label>
                        <input type="tel" id="quoteClientPhone" placeholder="(555) 123-4567">
                    </div>
                    
                    <div style="margin: 1rem 0; padding-bottom: 0.5rem; border-bottom: 1px solid var(--admin-border);">
                        <h4 style="font-size: 0.8rem; color: var(--admin-text-muted); text-transform: uppercase;">üí∞ Pricing</h4>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Upfront Cost *</label>
                            <input type="number" id="quoteUpfrontCost" placeholder="500" min="0" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label>Monthly Fee</label>
                            <input type="number" id="quoteMonthlyFee" placeholder="50" min="0" step="0.01">
                        </div>
                    </div>
                    
                    <div style="margin: 1rem 0; padding-bottom: 0.5rem; border-bottom: 1px solid var(--admin-border);">
                        <h4 style="font-size: 0.8rem; color: var(--admin-text-muted); text-transform: uppercase;">üìã Details</h4>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Service Type</label>
                            <select id="quoteServiceType">
                                <option value="website">Website Design</option>
                                <option value="maintenance">Maintenance</option>
                                <option value="custom">Custom Project</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Valid Until</label>
                            <input type="date" id="quoteValidUntil">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="quoteServiceDescription" rows="2" placeholder="What's included..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Client Notes</label>
                        <textarea id="quoteClientNotes" rows="2" placeholder="Message for client..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Internal Notes</label>
                        <textarea id="quoteInternalNotes" rows="2" placeholder="Private notes..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-ghost" onclick="adminPanel.closeQuoteModal()">Cancel</button>
                <button class="btn btn-primary" onclick="adminPanel.saveQuote()">üíæ Save Quote</button>
            </div>
        </div>
    </div>

    <!-- Quote View Modal -->
    <div id="quoteViewModal" class="modal-overlay" style="display: none;">
        <div class="modal" style="max-width: 500px;">
            <div class="modal-header">
                <h3>üé´ Quote Details</h3>
                <button class="modal-close" onclick="adminPanel.closeQuoteViewModal()">&times;</button>
            </div>
            <div class="modal-body" id="quoteViewContent">
                <div class="loading">Loading...</div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-ghost" onclick="adminPanel.closeQuoteViewModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Visitor Modal -->
    <div id="visitorModal" class="modal-overlay" style="display: none;">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <h3>üë§ Visitor Details</h3>
                <button class="modal-close" onclick="adminPanel.closeVisitorModal()">&times;</button>
            </div>
            <div class="modal-body" id="visitorModalContent">
                <div class="loading">Loading...</div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-ghost" onclick="adminPanel.closeVisitorModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/admin.js"></script>
</body>
</html>
